---
title: "procs"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{procs}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

The **procs** package contains functions that replicate procedures from
SAS® software. The intention of the package is to ease transition to R
adoption by providing SAS® programmers a familiar conceptual framework and 
functions that produce nearly identical output. Along the way, the 
functions in the **procs** package also provide much nicer output 
than existing R statistical functions.

### Key Functions

The package includes the following procedure functions:

* `proc_freq()`: A function to simulate the FREQ procedure.
* `proc_means()`: A function to simulate the MEANS or SUMMARY procedure.
* `proc_transpose()`: A function to pivot data similar in syntax to the 
TRANSPOSE procedure.
* `proc_sort()`: A function to sort and dedupe datasets.
* `proc_compare()`: A function to compare two datasets and report on 
the differences between them.
* `proc_print()`: A quick-print function to send procedure results to the viewer
or a report.


### How to Use


The following examples illustrate the basic functionality of each of the 
above three functions:

#### The `proc_freq()` Function

The `proc_freq()` function generates frequency statistics in a manner
similar to SAS® PROC FREQ.  

```{r eval=FALSE, echo=TRUE} 
library(procs)

dt <- as.data.frame(HairEyeColor, stringsAsFactors = FALSE)

labels(dt) <- list(Hair = "Hair Color",
                   Eye = "Eye Color")

res <- proc_freq(dt, tables = c("Hair", "Eye", "Hair * Eye"),
                 weight = "Freq",
                 options = opts(chisq = TRUE),
                 titles = "Hair and Eye Frequency Statistics",
                 out1 = out(table = "Hair * Eye"),
                 out2 = out(table = "Hair * Eye", stats = "chisq"))

```
By default, the following report will be shown in the viewer:
<img src="../man/images/freq1.png"/>

Also note that the `proc_freq()` function returned a list of two data frames
in the variable 'res', according to the output requests. The value of 'res'
is as follows:
```{r eval=FALSE, echo=TRUE} 
# View output datasets
res
# $out1
#    VAR1 VAR2  CAT1  CAT2   N CNT        PCT CUMSUM     CUMPCT
# 1  Hair  Eye Black  Blue 592  20  3.3783784     20   3.378378
# 2  Hair  Eye Black Brown 592  68 11.4864865     88  14.864865
# 3  Hair  Eye Black Green 592   5  0.8445946     93  15.709459
# 4  Hair  Eye Black Hazel 592  15  2.5337838    108  18.243243
# 5  Hair  Eye Blond  Blue 592  94 15.8783784    202  34.121622
# 6  Hair  Eye Blond Brown 592   7  1.1824324    209  35.304054
# 7  Hair  Eye Blond Green 592  16  2.7027027    225  38.006757
# 8  Hair  Eye Blond Hazel 592  10  1.6891892    235  39.695946
# 9  Hair  Eye Brown  Blue 592  84 14.1891892    319  53.885135
# 10 Hair  Eye Brown Brown 592 119 20.1013514    438  73.986486
# 11 Hair  Eye Brown Green 592  29  4.8986486    467  78.885135
# 12 Hair  Eye Brown Hazel 592  54  9.1216216    521  88.006757
# 13 Hair  Eye   Red  Blue 592  17  2.8716216    538  90.878378
# 14 Hair  Eye   Red Brown 592  26  4.3918919    564  95.270270
# 15 Hair  Eye   Red Green 592  14  2.3648649    578  97.635135
# 16 Hair  Eye   Red Hazel 592  14  2.3648649    592 100.000000
# 
# $out2
#   VAR1 VAR2    CHISQ CHISQ.DF      CHISQ.P
# 1 Hair  Eye 138.2898        9 2.325287e-25

```

#### The `proc_means()` Function

The `proc_means()` function attempts to provide similar functionality to 
the SAS® PROC MEANS procedure.

The below example takes the Hair frequencies calculated above and performs
some summary statistics on the frequencies using `proc_means()`:

```{r eval=FALSE, echo=TRUE} 
library(procs)

dt <- as.data.frame(HairEyeColor, stringsAsFactors = FALSE)

statlst <- c("n", "mean", "std", "median", "min", "max", "Q1", "Q3")

# Perform calculations
res2 <- proc_means(dt, var = Freq, 
                   stats = statlst,
                   class = Sex,
                   options = opts(aov = TRUE),
                   titles = "Hair and Eye Summary Statistics by Sex",
                   out1 = out(stats = statlst, 
                              shape = "wide"))
                   #out2 = out(stats = "aov"))

# View the summary statistics
res2
# [[1]]
# # A tibble: 1 × 6
#   Variable      N  Mean Std_Dev Minimum Maximum
#   <chr>     <int> <dbl>   <dbl>   <dbl>   <dbl>
# 1 Frequency     4   148    94.9      71     286
```

#### The `proc_transpose()` Function

While the main purpose of the **procs** package is to replicate SAS® statistical
procedures, the output from these procedures is often manipulated to
produce a more desirable result.  While R and Tidyverse do contain sufficient
data manipulation functions, the TRANSPOSE procedure from SAS® provides a 
somewhat different conceptual model that SAS® programmers like.  The aim
of the `proc_transpose()` function is to offer a similar model in R.

The following example takes the "Hair" frequencies from the `proc_freq()`
example above, and transposes the rows and columns:

```{r eval=FALSE, echo=TRUE} 
library(procs)

# Get Hair frequencies
dt <- res$Hair

# View Hair frequencies
dt
# # A tibble: 4 × 5
#   Category Frequency Percent Cum_Freq Cum_Pct
#   <chr>        <dbl>   <dbl>    <dbl>   <dbl>
# 1 Black          108    18.2      108    18.2
# 2 Blond          127    21.5      235    39.7
# 3 Brown          286    48.3      521    88.0
# 4 Red             71    12.0      592   100 

res3 <- proc_transpose(dt, var = c("Frequency", "Percent", "Cum_Freq", "Cum_Pct"),
                       id = "Category", name = "Statistic")

# View transformed data
res3
# # A tibble: 4 × 5
#   Statistic Black Blond Brown   Red
#   <chr>     <dbl> <dbl> <dbl> <dbl>
# 1 Frequency 108   127   286    71  
# 2 Percent    18.2  21.5  48.3  12.0
# 3 Cum_Freq  108   235   521   592  
# 4 Cum_Pct    18.2  39.7  88.0 100  
```

#### The `proc_sort()` Function


#### The `proc_compare()` Function


#### The `proc_print()` Function


### Next Steps

For next steps, please review the examples provided in the vignette articles. 
Those articles include:

* [The Frequency Function](procs-freq.html)
* [The Means Function](procs-means.html)
* [The Transpose Function](procs-transpose.html)
* [The Sort Function](procs-sort.html)
* [The Compare Function](procs-compare.html)
* [The Print Function](procs-print.html)
* [Package Validation](procs-validation.html)
* [Complete Example](procs-example1.html)




